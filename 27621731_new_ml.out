
Due to MODULEPATH changes, the following have been reloaded:
  1) mii/1.1.2

The following have been reloaded with a version change:
  1) StdEnv/2023 => StdEnv/2020
  2) blis/0.9.0 => blis/0.8.1
  3) flexiblas/3.3.1 => flexiblas/3.0.4
  4) gcccore/.12.3 => gcccore/.9.3.0
  5) gentoo/2023 => gentoo/2020
  6) libfabric/1.18.0 => libfabric/1.10.1
  7) openmpi/4.1.5 => openmpi/4.0.3
  8) ucx/1.14.1 => ucx/1.8.0

Defaulting to user installation because normal site-packages is not writeable
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: tensorflow==2.8 in /home/yaldaw/.local/lib/python3.10/site-packages (2.8.0+computecanada)
Requirement already satisfied: flatbuffers>=1.12 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (20190709135844+computecanada)
Requirement already satisfied: protobuf>=3.9.2 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (3.20.3+computecanada)
Requirement already satisfied: numpy>=1.20 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.25.2+computecanada)
Requirement already satisfied: libclang>=9.0.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (14.0.1+computecanada)
Requirement already satisfied: wrapt>=1.11.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.14.1+computecanada)
Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (0.32.0+computecanada)
Requirement already satisfied: tensorboard<2.9,>=2.8 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (2.8.0+computecanada)
Requirement already satisfied: keras-preprocessing>=1.1.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.1.2+computecanada)
Requirement already satisfied: keras<2.9,>=2.8.0rc0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (2.8.0+computecanada)
Requirement already satisfied: tf-estimator-nightly==2.8.0.dev2021122109 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (2.8.0.dev2021122109+computecanada)
Requirement already satisfied: h5py>=2.9.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (3.8.0+computecanada)
Requirement already satisfied: six>=1.12.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.10.2/lib/python3.10/site-packages (from tensorflow==2.8) (1.16.0)
Requirement already satisfied: opt-einsum>=2.3.2 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (3.3.0+computecanada)
Requirement already satisfied: astunparse>=1.6.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.6.3+computecanada)
Requirement already satisfied: setuptools in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.10.2/lib/python3.10/site-packages (from tensorflow==2.8) (60.7.1)
Requirement already satisfied: google-pasta>=0.1.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (0.2.0+computecanada)
Requirement already satisfied: gast>=0.2.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (0.5.4+computecanada)
Requirement already satisfied: typing-extensions>=3.6.6 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (4.10.0+computecanada)
Requirement already satisfied: absl-py>=0.4.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.4.0+computecanada)
Requirement already satisfied: termcolor>=1.1.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (2.4.0+computecanada)
Requirement already satisfied: grpcio<2.0,>=1.24.3 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorflow==2.8) (1.57.0+computecanada)
Requirement already satisfied: wheel<1.0,>=0.23.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.10.2/lib/python3.10/site-packages (from astunparse>=1.6.0->tensorflow==2.8) (0.37.1)
Requirement already satisfied: requests<3,>=2.21.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (2.31.0+computecanada)
Requirement already satisfied: werkzeug>=0.11.15 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (3.0.1+computecanada)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (0.6.1+computecanada)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (1.8.1+computecanada)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (0.4.6+computecanada)
Requirement already satisfied: google-auth<3,>=1.6.3 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (2.28.2)
Requirement already satisfied: markdown>=2.6.8 in /home/yaldaw/.local/lib/python3.10/site-packages (from tensorboard<2.9,>=2.8->tensorflow==2.8) (3.5.2+computecanada)
Requirement already satisfied: rsa<5,>=3.1.4 in /home/yaldaw/.local/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8) (4.9+computecanada)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8) (0.3.0+computecanada)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8) (5.3.3)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8) (1.4.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8) (3.3.2)
Requirement already satisfied: certifi>=2017.4.17 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8) (2024.2.2)
Requirement already satisfied: idna<4,>=2.5 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests<3,>=2.21.0->tensorboard<2.9,>=2.8->tensorflow==2.8) (2.0.7+computecanada)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from werkzeug>=0.11.15->tensorboard<2.9,>=2.8->tensorflow==2.8) (2.1.3+computecanada)
Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /home/yaldaw/.local/lib/python3.10/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.9,>=2.8->tensorflow==2.8) (0.5.1+computecanada)
Requirement already satisfied: oauthlib>=3.0.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.9,>=2.8->tensorflow==2.8) (3.2.2+computecanada)
Defaulting to user installation because normal site-packages is not writeable
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: comet_ml in /home/yaldaw/.local/lib/python3.10/site-packages (3.35.4+computecanada)
Requirement already satisfied: jsonschema!=3.1.0,>=2.6.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (4.21.1+computecanada)
Requirement already satisfied: requests>=2.18.4 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (2.31.0+computecanada)
Requirement already satisfied: urllib3>=1.21.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (2.0.7+computecanada)
Requirement already satisfied: psutil>=5.6.3 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (5.9.8)
Requirement already satisfied: rich>=13.3.2 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (13.7.1+computecanada)
Requirement already satisfied: python-box<7.0.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (6.1.0+computecanada)
Requirement already satisfied: semantic-version>=2.8.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (2.10.0+computecanada)
Requirement already satisfied: sentry-sdk>=1.1.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (1.40.6)
Requirement already satisfied: wurlitzer>=1.0.2 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (3.0.3+computecanada)
Requirement already satisfied: dulwich!=0.20.33,>=0.20.6 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (0.21.3+computecanada)
Requirement already satisfied: websocket-client<1.4.0,>=0.55.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (1.3.3+computecanada)
Requirement already satisfied: wrapt>=1.11.2 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (1.14.1+computecanada)
Requirement already satisfied: everett[ini]<3.2.0,>=1.0.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (3.1.0+computecanada)
Requirement already satisfied: requests-toolbelt>=0.8.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (1.0.0+computecanada)
Requirement already satisfied: simplejson in /home/yaldaw/.local/lib/python3.10/site-packages (from comet_ml) (3.19.2+computecanada)
Requirement already satisfied: six in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.10.2/lib/python3.10/site-packages (from comet_ml) (1.16.0)
Requirement already satisfied: configobj in /home/yaldaw/.local/lib/python3.10/site-packages (from everett[ini]<3.2.0,>=1.0.1->comet_ml) (5.0.8+computecanada)
Requirement already satisfied: attrs>=22.2.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet_ml) (23.2.0+computecanada)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /home/yaldaw/.local/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet_ml) (2023.12.1+computecanada)
Requirement already satisfied: referencing>=0.28.4 in /home/yaldaw/.local/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet_ml) (0.33.0+computecanada)
Requirement already satisfied: rpds-py>=0.7.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet_ml) (0.10.0+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests>=2.18.4->comet_ml) (2024.2.2)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests>=2.18.4->comet_ml) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /home/yaldaw/.local/lib/python3.10/site-packages (from requests>=2.18.4->comet_ml) (3.6)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from rich>=13.3.2->comet_ml) (2.17.2+computecanada)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/yaldaw/.local/lib/python3.10/site-packages (from rich>=13.3.2->comet_ml) (3.0.0+computecanada)
Requirement already satisfied: mdurl~=0.1 in /home/yaldaw/.local/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich>=13.3.2->comet_ml) (0.1.2+computecanada)
COMET INFO: Experiment is live on comet.com https://www.comet.com/enhancing-gradient/masking-effect/c768cb055fec40e1bf39c4e0e18bc2d0

2024-04-09 16:17:49.241172: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-09 16:17:50.387120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38212 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:01:00.0, compute capability: 8.0
WARNING:tensorflow:No training configuration found in the save file, so the model was *not* compiled. Compile it manually.
Traceback (most recent call last):
  File "/home/yaldaw/working_dir/yalda/ghostfacenet-ex/noise-masking.py", line 253, in <module>
    main()
  File "/home/yaldaw/working_dir/yalda/ghostfacenet-ex/noise-masking.py", line 215, in main
    pairs_dataset = create_pairs_dataset(pairs_file_path, dataset_dir, noise_factor).batch(32)
  File "/home/yaldaw/working_dir/yalda/ghostfacenet-ex/noise-masking.py", line 192, in create_pairs_dataset
    pairs_dataset = lines_dataset.map(load_and_preprocess)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 2016, in map
    return MapDataset(self, map_func, preserve_cardinality=True, name=name)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 5191, in __init__
    self._map_func = structured_function.StructuredFunctionWrapper(
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/data/ops/structured_function.py", line 271, in __init__
    self._function = fn_factory()
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/eager/function.py", line 3070, in get_concrete_function
    graph_function = self._get_concrete_function_garbage_collected(
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/eager/function.py", line 3036, in _get_concrete_function_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/eager/function.py", line 3292, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/eager/function.py", line 3130, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/framework/func_graph.py", line 1161, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/data/ops/structured_function.py", line 248, in wrapped_fn
    ret = wrapper_helper(*args)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/data/ops/structured_function.py", line 177, in wrapper_helper
    ret = autograph.tf_convert(self._func, ag_ctx)(*nested_args)
  File "/home/yaldaw/.local/lib/python3.10/site-packages/tensorflow/python/autograph/impl/api.py", line 692, in wrapper
    raise e.ag_error_metadata.to_exception(e)
TypeError: in user code:


    TypeError: outer_factory.<locals>.inner_factory.<locals>.tf__load_and_preprocess() takes 1 positional argument but 3 were given

COMET INFO: ---------------------------------------------------------------------------------------
COMET INFO: Comet.ml Experiment Summary
COMET INFO: ---------------------------------------------------------------------------------------
COMET INFO:   Data:
COMET INFO:     display_summary_level : 1
COMET INFO:     url                   : https://www.comet.com/enhancing-gradient/masking-effect/c768cb055fec40e1bf39c4e0e18bc2d0
COMET INFO:   Uploads:
COMET INFO:     environment details      : 1
COMET INFO:     filename                 : 1
COMET INFO:     git metadata             : 1
COMET INFO:     git-patch (uncompressed) : 1 (349.10 KB)
COMET INFO:     installed packages       : 1
COMET INFO:     source_code              : 1 (11.04 KB)
COMET INFO: 
